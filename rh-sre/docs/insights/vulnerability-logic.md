---
title: Red Hat Lightspeed Vulnerability Assessment Logic
category: insights
sources:
  - title: Assessing and Monitoring Security Vulnerabilities on RHEL Systems
    url: https://docs.redhat.com/en/documentation/red_hat_insights/1-latest/html/assessing_and_monitoring_security_vulnerabilities_on_rhel_systems/vuln-cves_vuln-overview
    sections: CVE identification, classification, threat intelligence
    date_accessed: 2026-01-20
  - title: Generating Vulnerability Service Reports
    url: https://access.redhat.com/documentation/en-us/red_hat_insights/1-latest/html-single/generating_vulnerability_service_reports/index
    sections: Executive reports, CVE reports, data export
    date_accessed: 2026-01-20
  - title: Red Hat CVE Database
    url: https://access.redhat.com/security/security-updates/cve
    sections: Official CVE entries, security updates
    date_accessed: 2026-01-20
  - title: A Complete View of System Vulnerabilities
    url: https://www.redhat.com/en/blog/complete-view-system-vulnerabilities-using-red-hat-insights
    sections: Vulnerability service overview, best practices
    date_accessed: 2026-01-20
tags: [insights, vulnerability, cve, risk-assessment, threat-intelligence]
applies_to: [rhel6, rhel7, rhel8, rhel9]
semantic_keywords:
  - "Red Hat Lightspeed"
  - "CVE assessment"
  - "vulnerability classification"
  - "threat intelligence"
  - "security rules"
  - "affected but not vulnerable"
  - "vulnerable status"
  - "CVSS score"
  - "severity rating"
  - "remediation priority"
use_cases:
  - "risk_assessment"
  - "cve_impact_analysis"
  - "remediation_prioritization"
  - "vulnerability_reporting"
related_docs:
  - "references/cvss-scoring.md"
  - "ansible/cve-remediation-templates.md"
  - "references/compliance-frameworks.md"
last_updated: 2026-01-20
---

# Red Hat Lightspeed Vulnerability Assessment Logic

This document explains how Red Hat Lightspeed assesses CVE vulnerabilities, classifies risk, and prioritizes remediation for RHEL systems.

## Overview

The Red Hat Lightspeed vulnerability service provides automated CVE assessment for RHEL systems registered with Lightspeed. It analyzes CVE impact, determines exploitability, and generates remediation recommendations.

**Key Capabilities**:
- Automated CVE identification on registered systems
- Threat intelligence integration
- Remediation playbook generation
- Executive and technical reporting
- Compliance tracking

## CVE Classification

### Vulnerable vs Affected But Not Vulnerable

Red Hat Lightspeed categorizes CVEs into two primary classifications:

#### Vulnerable
**Definition**: System is running flawed code with an **open path to exploitation**.

**Characteristics**:
- CVE exists in installed package
- No mitigating factors present
- Exploit path is viable
- System is exposed to risk

**Example**: RHEL 8 system running `httpd-2.4.37-1.el8` with CVE-2024-1234 affecting versions < 2.4.37-2.el8
- Package is vulnerable
- No compensating controls
- **Status**: Vulnerable ✗

**Action Required**: Immediate remediation recommended

#### Affected But Not Vulnerable
**Definition**: System has the vulnerable code, but **exploitation is not currently possible**.

**Characteristics**:
- CVE exists in installed package
- Mitigating factors prevent exploitation
- Configuration blocks exploit path
- Feature not enabled/used

**Mitigating Factors**:
- SELinux blocking exploit path
- Firewall preventing network access
- Service not enabled/running
- Feature compiled out or disabled
- Red Hat backported fix without version number change

**Example**: RHEL 8 system running `httpd-2.4.37-1.el8` with network-based CVE
- Package contains vulnerable code
- Firewall blocks external HTTP access
- **Status**: Affected but not vulnerable ⚠

**Action Required**: Lower priority, monitor for configuration changes

### Security Rules

**Security Rules** are CVEs that receive **elevated visibility** due to heightened risk.

**Criteria for Security Rule Status**:
- Significant media coverage
- Active exploitation in the wild
- High CVSS score (typically ≥ 8.0)
- Affects critical infrastructure
- Red Hat Product Security team escalation

**Example**: Log4Shell (CVE-2021-44228)
- CVSS 10.0
- Widespread exploitation
- Affects many RHEL systems
- **Designated as Security Rule**

**Impact**:
- Appears in executive dashboards
- Priority remediation recommended
- Enhanced reporting and tracking
- Compliance audit visibility

## Red Hat Severity Ratings

Red Hat uses a **4-point severity scale** in addition to CVSS scores:

| Severity | CVSS Range | Description | Response Time |
|----------|-----------|-------------|---------------|
| **Critical** | 9.0-10.0 | Easily exploitable, widespread impact, no user interaction | 24-48 hours |
| **Important** | 7.0-8.9 | Exploitable with moderate effort, significant impact | 7 days |
| **Moderate** | 4.0-6.9 | Requires specific conditions, limited impact | 30 days |
| **Low** | 0.1-3.9 | Difficult to exploit, minimal impact | 90 days |

**Red Hat Severity ≠ CVSS Score**

Red Hat severity considers:
- **Exploitability**: How easily can it be exploited?
- **Impact**: What damage can it cause?
- **Affected configurations**: How common is the vulnerable configuration?
- **Compensating controls**: Are mitigations available?
- **Customer environment**: How are customers actually using the software?

**Example**:
- **CVSS Score**: 8.5 (Important)
- **Red Hat Severity**: Moderate
- **Reason**: Requires non-default configuration rarely used in production

## Vulnerability Assessment Workflow

### Step 1: System Registration

```bash
# Register system with Red Hat Lightspeed
insights-client --register

# Verify registration
insights-client --status
```

**What Lightspeed Collects**:
- Installed packages and versions
- Running services
- System configuration
- SELinux status
- Firewall rules (high-level)
- Subscription data

**Privacy**: Lightspeed collects system metadata only, not application data or files.

### Step 2: CVE Identification

Lightspeed automatically:
1. Scans installed packages against Red Hat CVE database
2. Compares package versions to affected ranges
3. Identifies all applicable CVEs
4. Updates daily as new CVEs published

**CVE Sources**:
- Red Hat Product Security team
- NVD (National Vulnerability Database)
- Red Hat engineering analysis
- Customer-reported vulnerabilities

### Step 3: Exploitability Analysis

For each identified CVE, Lightspeed determines exploitability:

**Factors Analyzed**:
- SELinux policies (can SELinux block the exploit?)
- Service status (is the vulnerable service running?)
- Network exposure (is the service accessible remotely?)
- Feature enablement (is the vulnerable feature enabled?)
- Configuration (does config prevent exploitation?)

**Example Analysis**:
```
CVE-2024-1234: httpd remote code execution
Package: httpd-2.4.37-1.el8 (vulnerable version)

Exploitability Check:
✓ Service running: YES (httpd.service active)
✓ Network accessible: YES (port 80/443 open)
✓ SELinux blocking: NO (httpd_can_network_connect enabled)
✓ Feature enabled: YES (mod_cgi loaded)

Conclusion: VULNERABLE
```

### Step 4: Threat Intelligence Integration

Lightspeed integrates external threat intelligence:

**Data Sources**:
- Known exploits in the wild
- CISA Known Exploited Vulnerabilities (KEV) catalog
- Security researcher disclosures
- Red Hat threat intelligence feeds

**Impact on Priority**:
- **Active exploitation** → Escalate to Critical
- **Proof-of-concept available** → Increase priority
- **Theoretical only** → Standard priority

### Step 5: Remediation Recommendation

Lightspeed generates remediation recommendations:

**Automated Playbook Available**:
```
CVE-2024-1234 Remediation
─────────────────────────
Status: Automated remediation available
Package: httpd-2.4.37-1.el8 → httpd-2.4.37-2.el8
Reboot Required: No
Estimated Time: 5 minutes
Ansible Playbook: ✓ Available

Actions:
1. Download playbook from Lightspeed console
2. Review and customize for your environment
3. Execute via Ansible Automation Platform
4. Verify remediation success
```

**Manual Remediation Required**:
```
CVE-2024-5678 Remediation
─────────────────────────
Status: Manual remediation required
Package: custom-app-1.0 (not in Red Hat repos)
Guidance: Contact vendor for patch

Actions:
1. Review vendor security advisory
2. Test vendor-provided patch in staging
3. Schedule maintenance window
4. Apply patch manually
5. Re-scan with Lightspeed to verify
```

## Remediation Prioritization

### Priority Decision Matrix

Lightspeed prioritizes CVEs based on multiple factors:

| Factor | Weight | Description |
|--------|--------|-------------|
| **Severity** | 40% | Red Hat severity rating (Critical/Important/Moderate/Low) |
| **Exploitability** | 30% | Vulnerable vs Affected but not vulnerable |
| **Business Impact** | 20% | System criticality (production vs dev/test) |
| **Active Threats** | 10% | Known exploitation in the wild |

**Example Calculation**:
```
CVE-2024-1234:
- Severity: Important (7.0) → Score: 7.0 × 0.40 = 2.8
- Exploitability: Vulnerable → Score: 10 × 0.30 = 3.0
- Business Impact: Production → Score: 10 × 0.20 = 2.0
- Active Threats: PoC available → Score: 7.0 × 0.10 = 0.7

Total Priority Score: 8.5 / 10 → P1 (High Priority)
```

### Recommended Response Times

| Priority | Response Time | Typical Scenarios |
|----------|---------------|-------------------|
| **P0** | 24 hours | Critical + Vulnerable + Production + Active exploitation |
| **P1** | 7 days | Important + Vulnerable + Production |
| **P2** | 30 days | Moderate + Vulnerable or Important + Affected but not vulnerable |
| **P3** | 90 days | Low severity or non-production systems |

## Reporting Capabilities

### Executive Reports (PDF)

**Purpose**: High-level summary for leadership
**Contents**:
- Total CVE count by severity
- Trend analysis (improving/worsening)
- Top 10 critical CVEs
- Remediation progress metrics
- Compliance posture

**Generated via Lightspeed Console or API**

### CVE Reports (PDF)

**Purpose**: Detailed technical analysis
**Contents**:
- Filtered CVE list (by severity, date, system)
- Per-CVE details (CVSS, description, affected systems)
- Remediation guidance
- Timeline for resolution

### Vulnerability Data Export (CSV/JSON)

**Purpose**: Integration with other tools (SIEM, ticketing)
**Contents**:
- Complete CVE dataset
- System-to-CVE mapping
- Remediation status
- Custom fields

**Example Export**:
```csv
CVE,Severity,CVSS,Affected_Systems,Remediation_Available,Status
CVE-2024-1234,Important,7.5,15,Yes,Vulnerable
CVE-2024-5678,Moderate,5.3,8,No,Affected_but_not_vulnerable
```

## Integration with Remediation Agent

When using the remediation-agent plugin:

### Step 1: Risk Assessment (Use This Doc)

```yaml
# CVE Impact Skill uses vulnerability-logic.md
- Retrieve CVE data from Lightspeed
- Understand Red Hat severity rating
- Check if "vulnerable" or "affected but not vulnerable"
- Assess business impact
- Determine priority (P0/P1/P2/P3)
```

### Step 2: Remediation (Use Templates)

```yaml
# Remediator Agent uses cve-remediation-templates.md
- If priority = P0/P1: Generate playbook immediately
- If priority = P2: Schedule for maintenance window
- If priority = P3: Add to backlog

# Use appropriate template based on CVE type
- Package CVE → Template 1 (Package Update)
- Kernel CVE → Template 4 (Kernel Update)
- Service CVE → Template 2 (Service Restart)
```

## API Integration

### Lightspeed API Endpoints

**Get CVE Information**:
```bash
# Via lightspeed-mcp tool
vulnerability_get_cve_info(cve_id="CVE-2024-1234")

# Returns:
{
  "cve_id": "CVE-2024-1234",
  "severity": "Important",
  "cvss_score": 7.5,
  "publish_date": "2024-01-15",
  "description": "...",
  "affected_packages": ["httpd-2.4.37"],
  "remediation_available": true
}
```

**List Affected Systems**:
```bash
vulnerability_list_cves(cve_id="CVE-2024-1234")

# Returns:
{
  "systems": [
    {
      "uuid": "abc-123",
      "hostname": "web-server-01",
      "status": "vulnerable",
      "package": "httpd-2.4.37-1.el8"
    }
  ]
}
```

## Best Practices

### 1. Regular Scanning

- **Daily scans**: Automated via `insights-client` systemd timer
- **On-demand scans**: After patching to verify remediation
- **Post-change scans**: After system configuration changes

```bash
# Force immediate scan
insights-client --force-reregister
```

### 2. Understand Context

Don't remediate solely based on CVSS:
- ✅ Check Red Hat severity rating
- ✅ Verify "vulnerable" vs "affected but not vulnerable"
- ✅ Consider system criticality
- ✅ Review threat intelligence
- ❌ Don't auto-patch based on CVSS alone

### 3. Prioritize Production

```
Production Vulnerable > Production Affected > Non-Prod Vulnerable
```

### 4. Track Remediation Progress

- Use Lightspeed dashboards
- Export metrics for management
- Set SLAs per priority level
- Audit remediation completion

### 5. Compliance Integration

Map CVE remediation to compliance frameworks:
- **PCI-DSS**: High/Critical CVEs must be remediated per timeline
- **SOC 2**: Vulnerability management process documented
- **NIST**: CVE scoring aligns with NIST guidelines

See: [compliance-frameworks.md](../references/compliance-frameworks.md)

## Common Scenarios

### Scenario 1: Security Rule Announced

```
Notification: CVE-2024-9999 designated as Security Rule
Severity: Critical (CVSS 9.8)
Affected Systems: 127 systems

Workflow:
1. Read vulnerability-logic.md to understand Security Rule criteria
2. Assess: 127 systems × Critical severity = P0 priority
3. Generate batch remediation playbook (Template 6)
4. Execute rolling updates (serial: 5 for safety)
5. Verify all systems remediated within 24 hours
```

### Scenario 2: Affected But Not Vulnerable

```
CVE: CVE-2024-1111
Status: Affected but not vulnerable
Reason: SELinux prevents exploitation

Workflow:
1. Read vulnerability-logic.md to understand classification
2. Document why not vulnerable (SELinux policy blocks exploit)
3. Monitor for configuration changes (if SELinux disabled → becomes vulnerable)
4. Remediate during next maintenance window (not urgent)
5. Update documentation for audit purposes
```

### Scenario 3: No Automated Remediation

```
CVE: CVE-2024-2222
Package: third-party-app-1.0
Remediation: Manual steps required

Workflow:
1. Check Red Hat CVE database for guidance
2. Contact vendor for security advisory
3. Create custom remediation playbook
4. Test in staging environment
5. Document manual steps for audit trail
```

## Troubleshooting

### Issue: System Not Showing CVEs

**Possible Causes**:
- System not registered with Lightspeed
- `insights-client` service not running
- Subscription not active
- Network connectivity issues

**Resolution**:
```bash
# Check registration
insights-client --status

# Re-register if needed
insights-client --register

# Force update
insights-client --force-reregister
```

### Issue: CVE Shows "Affected But Not Vulnerable" When It Shouldn't

**Possible Causes**:
- Lightspeed detected mitigating factor (SELinux, firewall)
- Configuration analysis outdated
- False positive

**Resolution**:
1. Review system configuration
2. Verify mitigating factors actually present
3. If Lightspeed wrong: Contact Red Hat support
4. Override classification if necessary (document reason)

### Issue: Remediation Playbook Failed

**Possible Causes**:
- Package dependency conflicts
- Repository not accessible
- System requires reboot (not detected)

**Resolution**:
1. Review playbook execution logs
2. Check `package_update.results` for errors
3. Consult [package-management.md](../rhel/package-management.md) for troubleshooting
4. Re-run with increased verbosity: `ansible-playbook -vvv`

## Related Documentation

- **[CVSS Scoring Reference](../references/cvss-scoring.md)** - Detailed CVSS interpretation
- **[CVE Remediation Templates](../ansible/cve-remediation-templates.md)** - Playbook templates for remediation
- **[Compliance Frameworks](../references/compliance-frameworks.md)** - Compliance requirements per CVE severity

## Official Red Hat Sources

This document is derived from:

1. **Assessing and Monitoring Security Vulnerabilities on RHEL Systems**
   https://docs.redhat.com/en/documentation/red_hat_insights/1-latest/html/assessing_and_monitoring_security_vulnerabilities_on_rhel_systems/vuln-cves_vuln-overview

2. **Generating Vulnerability Service Reports**
   https://access.redhat.com/documentation/en-us/red_hat_insights/1-latest/html-single/generating_vulnerability_service_reports/index

3. **Red Hat CVE Database**
   https://access.redhat.com/security/security-updates/cve

4. **A Complete View of System Vulnerabilities Using Red Hat Lightspeed**
   https://www.redhat.com/en/blog/complete-view-system-vulnerabilities-using-red-hat-insights

**License**: Content derived from Red Hat documentation under CC BY-SA 4.0
**Last Verified**: 2026-01-20
